2025-07-03 15:11:15,170 - INFO - ===== 学业困难学生识别 - 决策树模型 =====
2025-07-03 15:11:15,171 - INFO - 加载预处理数据...
2025-07-03 15:11:15,314 - INFO - 数据加载成功，形状: (31482, 62)
2025-07-03 15:11:15,314 - INFO - 准备特征和目标变量...
2025-07-03 15:11:15,314 - INFO - 训练时已去除final_result列，防止信息泄露。
2025-07-03 15:11:15,320 - INFO - 学业困难学生比例: 53.45% (16827/31482)
2025-07-03 15:11:15,320 - INFO - 划分训练集和测试集 (80:20)...
2025-07-03 15:11:15,335 - INFO - 训练集: 25185 样本
2025-07-03 15:11:15,336 - INFO - 测试集: 6297 样本
2025-07-03 15:11:15,336 - INFO - 创建预处理和建模管道...
2025-07-03 15:11:15,336 - INFO - 开始网格搜索优化超参数...
2025-07-03 15:11:37,480 - INFO - 网格搜索完成!
2025-07-03 15:11:37,481 - INFO - 最佳参数: {'classifier__max_depth': 7, 'classifier__min_samples_leaf': 4, 'classifier__min_samples_split': 10}
2025-07-03 15:11:37,481 - INFO - 最佳交叉验证F1分数: 0.8943
2025-07-03 15:11:37,483 - INFO - 模型已保存至: ../Outputs/DecisionTree\decision_tree_model.pkl
2025-07-03 15:11:37,483 - INFO - 评估模型性能...
2025-07-03 15:11:37,727 - INFO - 评估完成，耗时: 0.24秒
2025-07-03 15:11:37,727 - INFO - 
==================== 模型性能指标 ====================
2025-07-03 15:11:37,728 - INFO - 准确率 (Accuracy): 0.8961
2025-07-03 15:11:37,728 - INFO - 精确率 (Precision): 0.9587
2025-07-03 15:11:37,728 - INFO - 召回率 (Recall): 0.8419
2025-07-03 15:11:37,728 - INFO - F1分数 (F1-Score): 0.8966
2025-07-03 15:11:37,728 - INFO - ROC AUC分数: 0.9481
2025-07-03 15:11:37,728 - INFO - 
==================== 混淆矩阵 ====================
2025-07-03 15:11:37,728 - INFO - 
[[2809  122]
 [ 532 2834]]
2025-07-03 15:11:37,728 - INFO - 
==================== 分类报告 ====================
2025-07-03 15:11:37,728 - INFO - 
              precision    recall  f1-score   support

        正常学生       0.84      0.96      0.90      2931
      学业困难学生       0.96      0.84      0.90      3366

    accuracy                           0.90      6297
   macro avg       0.90      0.90      0.90      6297
weighted avg       0.90      0.90      0.90      6297

2025-07-03 15:11:37,732 - INFO - 评估指标已保存至: ../Outputs/DecisionTree\metrics.csv
2025-07-03 15:11:37,732 - INFO - 使用SHAP进行特征解释分析...
2025-07-03 15:11:37,732 - INFO - 初始化SHAP解释器...
2025-07-03 15:11:37,739 - INFO - 计算 1000 个样本的SHAP值...
2025-07-03 15:11:38,536 - INFO - SHAP摘要图已保存至: ../Outputs/DecisionTree\shap_results\shap_summary.png
2025-07-03 15:11:38,536 - INFO - SHAP条形图已保存至: ../Outputs/DecisionTree\shap_results\shap_bar.png
2025-07-03 15:11:38,536 - INFO - 
Top 10 重要特征 (基于SHAP值):
2025-07-03 15:11:38,538 - INFO -                  Feature  Mean |SHAP|
12   date_unregistration     0.146207
46     total_clicks_page     0.007871
57   overall_active_days     0.006821
59      early_engagement     0.005865
45   total_clicks_ouwiki     0.003003
20  active_days_homepage     0.002862
48     total_clicks_quiz     0.002282
30  active_days_resource     0.000596
5      highest_education     0.000125
52  total_clicks_subpage     0.000101
2025-07-03 15:11:38,538 - INFO - 保存决策树结构图...
2025-07-03 15:11:38,715 - INFO - 决策树结构图已保存至: ../Outputs/DecisionTree\decision_tree_graphviz
2025-07-03 15:11:38,853 - INFO - ROC曲线已保存至: ../Outputs/DecisionTree\roc_curve.png
2025-07-03 15:11:38,853 - INFO - 
===== 决策树模型总结 =====
2025-07-03 15:11:38,853 - INFO - 学业困难学生识别率 (召回率): 84.19%
2025-07-03 15:11:38,853 - INFO - 模型准确率: 89.61%
2025-07-03 15:11:38,853 - INFO - F1分数: 0.8966
2025-07-03 15:11:38,853 - INFO - ROC AUC: 0.9481
2025-07-03 15:11:38,853 - INFO - 学业困难学生识别任务完成!
